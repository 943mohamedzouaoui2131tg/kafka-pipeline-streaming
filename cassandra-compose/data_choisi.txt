docker exec -it cassandra1 cqlsh
--------------------------------

les donner utliser :

PULocationID,
DOLocationID,
Borough,
Zone,
service_zone,
Somme Passenger_count,
Somme Trip_distance,
count Tarif standard(RateCodeID==1),
count JFK(RateCodeID==2),
count Newark(RateCodeID==3),
count Nassau ou Westchester(RateCodeID==4),
count Tarif négocié(RateCodeID==5),
count Trajet de groupe(RateCodeID==6),
count Payment_type==1 : Carte bancaire,
count Payment_type==2 : Espèces,
count Payment_type==3 : Gratuit,
count Payment_type==4 : Litige,
count Payment_type==5 : Inconnu,
count Payment_type==6 : Trajet annulé,
somme Fare_amount,
somme MTA_tax,
somme Tip_amount,
somme Total_amount,
tpep_pickup_datetime,
tpep_dropoff_datetime,
count VendorID==1 : Creative Mobile Technologies, LLC
count VendorID==2 : VeriFone Inc.

======================================================================================

la table de Cassandra : 
 ==== KEYSPACE =====
CREATE KEYSPACE Projet_bd
WITH replication = {
  'class': 'NetworkTopologyStrategy',
  'datacenter1': 2
};
===================
 USE Projet_bd;
===================

CREATE TABLE trips_by_borough_time (
    borough TEXT,
    year_month TEXT,
    pickup_date DATE,
    pickup_hour INT,
    
    -- Métriques agrégées
    sum_passenger_count DOUBLE,
    count_rate_standard BIGINT,
    count_rate_jfk BIGINT,
    count_rate_newark BIGINT,
    count_rate_nassau BIGINT,
    count_rate_negotiated BIGINT,
    count_rate_group BIGINT,

    count_payment_card BIGINT,
    count_payment_cash BIGINT,
    count_payment_free BIGINT,
    count_payment_dispute BIGINT,
    count_payment_unknown BIGINT,
    count_payment_voided BIGINT,

    sum_fare_amount DOUBLE,
    sum_mta_tax DOUBLE,
    sum_tip_amount DOUBLE,
    sum_total_amount DOUBLE,

    count_vendor_cmt BIGINT,
    count_vendor_verifone BIGINT,

    PRIMARY KEY ((borough, year_month), pickup_date, pickup_hour)
) WITH CLUSTERING ORDER BY (pickup_date ASC, pickup_hour ASC);


CREATE TABLE trips_by_pickup_zone (
    borough TEXT,
    year_month TEXT,
    pickup_date DATE,
    pickup_hour INT,
    pickup_zone TEXT,
    service_zone TEXT,
    
    sum_passenger_count DOUBLE,
    avg_trip_distance DOUBLE,
    sum_fare_amount DOUBLE,
    sum_tip_amount DOUBLE,
    sum_total_amount DOUBLE,
    
    count_payment_card BIGINT,
    count_payment_cash BIGINT,
    count_payment_free BIGINT,
    count_payment_dispute BIGINT,
    count_payment_unknown BIGINT,
    count_payment_voided BIGINT,
    
    count_vendor_cmt BIGINT,
    count_vendor_verifone BIGINT,

    PRIMARY KEY ((borough, year_month), pickup_date, pickup_hour, pickup_zone)
) WITH CLUSTERING ORDER BY (pickup_date ASC, pickup_hour ASC, pickup_zone ASC);




CREATE TABLE trips_by_route (
    pickup_location_id INT,
    pickup_zone TEXT,
    dropoff_location_id INT,
    dropoff_zone TEXT,
    year_month TEXT,
    pickup_date DATE,
    
    -- Métriques agrégées
    
    avg_trip_distance DOUBLE,
    avg_duration INT,
    avg_fare_amount DOUBLE,
    avg_tip_amount DOUBLE,
    avg_passenger_count DOUBLE,

    count_payment_card bigint,
    count_payment_cash bigint,
    count_payment_free bigint,
    count_payment_dispute bigint,
    count_payment_unknown bigint,
    count_payment_voided bigint,

    PRIMARY KEY ((pickup_location_id, year_month), 
                 dropoff_location_id, pickup_date)
) WITH CLUSTERING ORDER BY (dropoff_location_id ASC, pickup_date DESC);


CREATE TABLE trips_by_vendor (
    vendor_id INT,
    borough TEXT,
    year_month TEXT,
    pickup_date DATE,
    pickup_location_id INT,
    
    -- Métriques agrégées
    sum_passenger_count DOUBLE,
    avg_trip_distance DOUBLE,
    sum_total_amount DOUBLE,
    sum_tip_amount DOUBLE,
    sum_mta_tax DOUBLE,

    count_payment_card bigint,
    count_payment_cash bigint,
    count_payment_free bigint,
    count_payment_dispute bigint,
    count_payment_unknown bigint,
    count_payment_voided bigint,

    PRIMARY KEY ((vendor_id, borough, year_month), 
                 pickup_date, pickup_location_id)
) WITH CLUSTERING ORDER BY (pickup_date DESC, pickup_location_id ASC);

